(()=>{const t=/^\d+$/,n=/^[A-Z][A-Z0-9_]*$/,r=/^\x03\uE904?\n+$/,e=new Set(["Attr","Bluetooth","Clipboard","Crypto","CSSStyleDeclaration","DataView","DOMStringList","DOMStringMap","DOMTokenList","External","Geolocation","History","HTMLCollection","HTMLDocument","HTMLBodyElement","HTMLDivElement","HTMLSpanElement","IDBDatabase","IDBFactory","Ink","Keyboard","Location","MessagePort","NamedNodeMap","Navigation","Navigator","NodeList","Object","Performance","PerformanceTiming","Permissions","Plugin","Presentation","Promise","Scheduler","Scheduling","Screen","Serial","ServiceWorker","ServiceWorkerContainer","Storage","StylePropertyMap","SVGAnimatedLength","SVGAnimatedPreserveAspectRatio","SVGAnimatedRect","SVGAnimatedString","SVGLength","SVGPoint","SVGPreserveAspectRatio","SVGRect","SVGStringList","SVGSVGElement","TrustedHTML","TrustedScriptURL","Uint8Array","Window","XMLHttpRequest","XMLHttpRequestUpload"]),o=new Set(["$$class/0","context","counter","cursor","experimentIds","head","itemIds","menu","n:slide","next","offset","parent","promise","resourceKeys","size","storage","timing","token","transform","value"]);let c=null,i=null,s=null;function u(t,n=self){try{for(const r of t)n=n[r];return n}catch{return null}}function a(t){return t instanceof Object}function l(t){if("Object"!==t.constructor.name)return!1;const r=Object.getOwnPropertyNames(t);if(0===r.length)return!1;for(const e of r){const r=t[e];if(!n.test(e)||!a(r))return!1}return!0}function f(t){return!Array.isArray(t)&&"Object"!==t.constructor.name&&t.hasOwnProperty("properties")&&a(t.properties)&&"Object"===t.properties.constructor.name&&t.hasOwnProperty("transform")&&a(t.transform)&&"Object"!==t.transform.constructor.name}function p(t){if(!(!Array.isArray(t)&&"Object"!==t.constructor.name&&!t.hasOwnProperty("properties")&&t.hasOwnProperty("transform")&&a(t.transform)&&"Object"!==t.transform.constructor.name))return!1;for(const n in t){const r=t[n];if(a(r)&&m(r))return!0}return!1}function m(t){try{if(!Array.isArray(t))return!1;if(0===t.length)return!1;for(const n of t)if(!a(n)||!f(n)&&!p(n))return!1;return!0}catch{return!1}}function y(t){if(!(!Array.isArray(t)&&"Object"!==t.constructor.name&&!t.hasOwnProperty("properties")&&t.hasOwnProperty("transform")&&a(t.transform)&&"Object"!==t.transform.constructor.name))return!1;for(const n in t){const r=t[n];if(a(r)&&l(r))return!1}for(const n in t){const r=t[n];if(a(r)&&m(r))return!0}return!1}function h(t){try{if(!Array.isArray(t))return!1;if(0===t.length)return!1;for(const n of t)if(!a(n)||!y(n))return!1;return!0}catch{return!1}}function S(t,n){if(t instanceof Window||t instanceof Node||t instanceof Map||t instanceof Set||t instanceof Date||t instanceof RegExp||e.has(t.constructor.name)||o.has(n))return!0;if(y(t))return!0;for(const n in t){const r=t[n];if("string"==typeof r&&r.includes("presentation"))return!0}return!1}function d(){const n=function(){const n=document.querySelector("g.punch-filmstrip-thumbnail rect.punch-filmstrip-thumbnail-border[style*='stroke']"),r=n?.closest("g.punch-filmstrip-thumbnail"),e=r?.querySelector("text.punch-filmstrip-thumbnail-pagenumber");return e?.textContent&&t.test(e.textContent)?+e.textContent-1:null}();if(null===n)return null;const r=null!==c;if(r||(c=function(){const t=self.SK_app;if(!a(t))return null;for(const n in t)try{const r=t[n];if(!a(r))continue;for(const t in r){const e=r[t];if(a(e)&&h(e))return["SK_app",n,t]}}catch{}return null}()),null===c)return null;if(r){const t=u(c);return a(t)&&h(t)&&n<t.length?t[n]:(c=null,d())}{const t=u(c);return null!==t&&n<t.length?t[n]:(c=null,null)}}function g(t){const n=null!==i;if(n||(i=function(t){for(const n in t)try{const r=t[n];if(!a(r))continue;if(m(r))return[n]}catch{}return null}(t)),null===i)return null;if(n){const n=u(i,t);return a(n)&&m(n)?n:(i=null,g(t))}return u(i,t)}function N(t){try{const n=Object.getOwnPropertyNames(t);if(4!==n.length)return null;let r=0,e=0,o="";for(const c of n){const n=t[c];if(a(n)&&!Array.isArray(n))r++;else{if("string"!=typeof n||""!==n[0]||"\n"!==n[n.length-1])return null;e++,o=c}}return 3===r&&1===e?o:null}catch{return null}}function A(t){try{if(null!==s){const n=t[s[0].propName];if(!a(n))return null;if(n.constructor.name!==s[0].constrName)return null;const r=n[s[1].propName];if(!a(r))return null;if(r.constructor.name!==s[1].constrName)return null;const e=r[s[2].propName];return"string"!=typeof e?null:{value:e,path:s}}for(const n in t){const r=t[n];if(!(!a(r)||Array.isArray(r)||S(r,n)))for(const t in r){const e=r[t];if(!a(e)||Array.isArray(e)||S(e,t))continue;const o=N(e);if(null!==o)return{value:e[o],path:[{propName:n,constrName:r.constructor.name},{propName:t,constrName:e.constructor.name},{propName:o}]}}}}catch{}return null}document.addEventListener("LanguageTool-getSlideTextParts",t=>{try{const n=t.detail?.datasetPropName;n&&(document.body.dataset[n]=JSON.stringify(function(){const t=d();if(null===t)return[];const n=g(t);if(null===n)return[];const e=[n],o=new Set([n]),c=[],i=performance.now();for(const t of e){for(const n in t){const r=t[n];if(!a(r))continue;if(o.has(r))continue;if(S(r,n))continue;const i=A(r);o.add(r),null===i?e.push(r):c.push(i)}if(performance.now()-i>50)break}if(null===s&&c.length>0){s=c[0].path;for(const t of c){const n=t.path;if(s[0].propName!==n[0].propName||s[0].constrName!==n[0].constrName||s[1].propName!==n[1].propName||s[1].constrName!==n[1].constrName||s[2].propName!==n[2].propName){s=null;break}}}return c.map(t=>t.value).filter(t=>!r.test(t))}()))}catch{}})})();